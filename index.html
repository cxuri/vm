<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>v86 - CTF Environment</title>
<script src="boot/libv86.js"></script>

<style>
    /* 1. GLOBAL STYLING: High-contrast, 'Hacker' Theme */
    body {
        background: #000; /* True Black */
        color: #ddd;
        font-family: 'Consolas', 'Menlo', monospace; /* Professional terminal font */
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        padding: 20px;
    }

    /* 2. MAIN SCREEN CONTAINER */
    #screen_container {
        background: #000;
        border: 2px solid #00FFFF; /* Vibrant Cyan border */
        width: 800px;
        height: 600px;
        position: relative;
        overflow: hidden;
        margin-bottom: 10px;
    }

    /* 3. EARLY BOOT TEXT STYLING (The Div Overlay) */
    #screen_container > div {
        white-space: pre; 
        font: 16px 'Fira Mono', monospace; 
        font-weight: 400;
        line-height: 1.5; 
        color: #00FFFF; /* Vibrant Cyan Text */
        background-color: #000000;
        padding: 15px;
        position: absolute; 
        z-index: 10;
        width: 100%; /* <-- KEEP THIS */
        height: 100%; /* <-- KEEP THIS */
        box-sizing: border-box;
    }

    #screen_container canvas {
        display: block;
        width: 100%;
        height: 100%;
    }

    /* 4. VM CONTROLS STYLING */
    .controls {
        margin-bottom: 15px;
        background: #111;
        padding: 10px 20px;
        border-radius: 5px;
        border: 1px solid #00FFFF;
    }

    button {
        background: #333;
        color: #fff;
        border: 1px solid #00FFFF;
        padding: 5px 15px;
        cursor: pointer;
        font-family: inherit;
        margin: 0 5px;
    }

    button:hover { 
        background: #00FFFF; 
        color: #000;
    }
    
    /* Removed the #terminal CSS block */
</style>
</head>
<body>

    <div class="controls">
        <strong>VM Controls:</strong>
        <button onclick="emulator.stop()">‚è∏ Pause</button>
        <button onclick="emulator.run()">‚ñ∂ Resume</button>
        <button onclick="emulator.restart()">üîÑ Reset</button>
        <span style="margin-left: 10px; color: #888;">CTF Environment Running</span>
    </div>

    <div id="screen_container">
        <div style="
            white-space: pre; 
            font: 16px 'Fira Mono', monospace; 
            font-weight: 800;
            line-height: 1.5; 
            color: #00FFFF; 
            background-color: #000000;
            padding: 15px;
        "></div>
        <canvas></canvas> 
    </div>

    <script>
    var emulator = new V86({
        wasm_path: "boot/v86.wasm",
        memory_size: 512 * 1024 * 1024,
        vga_memory_size: 8 * 1024 * 1024,
        
        screen_container: document.getElementById("screen_container"),

        bios: { url: "boot/seabios.bin" },
        vga_bios: { url: "boot/vgabios.bin" },

        // --- LOAD YOUR CUSTOM BUILDROOT IMAGE ---
        bzimage : {
            url: "boot/bzImage"
        },
        initrd: {
            url: "boot/rootfs.cpio.gz"
        },

        hda : {
            url : "./ctf.img",
        },

        
        // --- CRITICAL: SECURITY DISABLING COMMAND LINE ---
        // Removed 'console=
        autostart: true,
        disable_mouse: false
    });
    
    // Removed the serial listener
</script>
</body>
</html>